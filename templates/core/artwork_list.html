{% extends "base.html" %}
{% load cloudinary %}

{% block content %}
    <div id="container">
        {% for artwork in artworks %}
            <div class="item">
                <a href="{{ artwork.get_absolute_url }}">
                    {# Renders an IMG tag for a CloudinaryImage objects. #}
                    {# THUMBNAIL defined in context_processors #}
                    {% cloudinary artwork.get_photo.image THUMBNAIL %}
                    <p>{{ artwork.title }} - {{ artwork.artist }}</p>
                </a>
            </div>
        {% endfor %}
    </div>
    {% include "includes/_pagination.html" %}
{% endblock content %}

{% block js %}
    {{ block.super }}
    <script>
        var $container = $('#container');
        // initialize
        $container.masonry({
            columnWidth: 270,
            itemSelector: '.item',
            gutter: 15,
            isFitWidth: true,
            isInitLayout: false
        });

        // layout Masonry again after all images have loaded
        $container.imagesLoaded(function () {
            $container.masonry();
        });

        $container.infinitescroll(
                {
                    navSelector: ".pagination",
                    nextSelector: ".next",
                    itemSelector: ".item",
                    loading: {
                        finishedMsg: "",
                        img: "http://pathtoyour.com/loading.gif",
                        msg: null,
                        msgText: ""
                    }
                },
                function (newItems) {
                    var $newItems = $(newItems).css({"opacity": 0});
                    $newItems.imagesLoaded(function () {
                        $newItems.animate({"opacity": 1});
                        $container.masonry("appended", $newItems, true);
                    });
                }
        );
    </script>
{% endblock js %}